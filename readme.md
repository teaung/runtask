############# serv39-trainrungraph 运行任务模块 #################

ATO命令下发流程如下：

1、到达转换轨\折返轨的处理：
	1.1 收到到达转换轨的消息后，保存列车位置信息
	1.2 收到运行图的时刻表时
		（1）更新mapRunTask
		（2）检查是否有该车的位置信息，若有，则发送ATO命令信息

2、到站消息（未停稳）的处理
	2.1  收到到站消息后，更新列车位置信息；
	2.2 根据表号、车次号、车组号获取运行任务信息：
		若为非计划车（表号为0），则将该列车位置信息移除；
		若为计划车，且满足一下3个条件之一：
		（1）任务列表为空
		（2）(或者)任务列表不为空且车组号相同车次号不同
		（3）(或者)任务列表不为空且无该车组号对应的任务列表
		则从运行图服务中获取新的任务列表，若有该计划车的运行图任务，则更新mapRunTask，否则发告警信息
		否则返回mapRunTask中已存在的运行任务信息，若mapRunTask为空，则返回null
	2.3 当满足计划车且有其运行任务时，则发送ATO命令信息

3、到站消息（停稳）的处理
	3.1  根据表号、车次号、车组号获取运行任务信息：
		若为非计划车（表号为0），则将该列车位置信息移除；
		若为计划车，且满足一下3个条件之一：
		（1）任务列表为空
		（2）(或者)任务列表不为空且车组号相同车次号不同
		（3）(或者)任务列表不为空且无该车组号对应的任务列表
		则从运行图服务中获取新的任务列表，若有该计划车的运行图任务，则更新mapRunTask，否则发告警信息
		否则返回mapRunTask中已存在的运行任务信息，若mapRunTask为空，则返回null
	3.2 当满足计划车且有其运行任务时，则发送（计划车）发车倒计时消息
	3.3 当满足非计划车，则发送（非计划车）发车倒计时消息
	
4、离开折返轨消息的处理
	4.1  根据表号、车次号、车组号获取运行任务信息：
		若为非计划车（表号为0），则将该列车位置信息移除；
		若为计划车，且满足一下3个条件之一：
		（1）任务列表为空
		（2）(或者)任务列表不为空且车组号相同车次号不同
		（3）(或者)任务列表不为空且无该车组号对应的任务列表
		则从运行图服务中获取新的任务列表，若有该计划车的运行图任务，则更新mapRunTask，否则发告警信息
		否则返回mapRunTask中已存在的运行任务信息，若mapRunTask为空，则返回null
	4.2 当满足计划车且有其运行任务时，则发送ATO命令信息

	
#更新：20180104	
一、离站
	1、更新ATO的Map(默认无人工命令，即跳停、扣车、人工停站时间等命令)
	2、判断是否有跳停
		2.1  有跳停，从Map中获取相应的ATO命令，设置相应字段并发送；
		2.2 无跳停，从Map中获取相应的ATO命令并发送。

二、进站
	1、再次更新ATO的Map
	2、有扣车，从Map中获取相应的ATO命令，设置相应字段并发送；
	3、有跳停，从Map中获取相应的ATO命令，设置相应字段并发送；
	       无跳停，从Map中获取相应ATO命令并发送。
	      
三、在站台上
	1、设置扣车，从Map中获取相应的ATO命令，设置相应字段并发送；
	2、取消扣车，从Map中获取相应的ATO命令
	
四、在区间
	1、从Map中获取对应的ATO命令(若没有，则产生新的ATO命令)
	2、有跳停，从Map中获取相应的ATO命令，设置相应字段并发送；
	       无跳停，从Map中获取相应ATO命令并发送。  
注：
	1、(1号站)离站时-->下一站离站前:以下字段保持不变
		下一停车站台ID：(2号站)
		停站时间：(2号站停站时间)
		下一区间运行时间：(1号站-->2号站区间运行时间)
	2、所有从Map中获取相应的ATO命令为null时，都要重新生成一份
	3、设置立即发车时，从Map中获取相应是ATO命令，修改相应字段并发送(必须满足没有扣车命令时才能下发)
